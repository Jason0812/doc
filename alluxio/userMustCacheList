# Alluxio MustCacheList 设计

场景需求：有部分数据只想缓存在Alluxio Space中，从而减轻HDFS namenode的压力；此类数据包括：

1. 在MR（hive）计算过程中，hive的中间数据，比如说Jar，job.xml这类文件放到Alluxio Space中，因为Alluxio Master加的锁的颗粒度较细，从而能够提高并发度；
2. 存储有一定时期限制的，同时此类数据是可以丢失的；比如说MR和Spark的History log（在集群数量较大的时候，此类文件的文件数量很大），可以只放进Alluxio的space中；
   1. 减轻了对UFS的压力，包括namenode的Memory压力，和namenode的GC压力；因为频繁的创建文件和删除文件，造成一定的Memory碎片问题，在CMS中，如果触发Full GC，延迟将会是很高的（因为在较大的集群中，namenode的内存一般都是较大的，当前我们的内存是80GB（600 datanodes）；
   2. 因为当前Alluxio Space中文件的没有副本，所以这种不能使用于需要持久化的数据；



## 实现方法

在Alluxio中Master创建文件和路径的时候，在client端对创建的文件和路径进行判断，看文件和路径是否在UserMustCacheList中，如果在就将WriteType设置为MustCache，从而实现将文件只cache在Alluxio Space中；

Alluxio中自带的whiteList的含义：是否cache；并不关心是否持久化；

我们设计的功能是：只cache在alluxio Space中，不必进行持久化（persist参数设为FALSE）；

**此参数在client端配置**
